---
title: Authentication
description: Secure API key authentication with sandbox and production environments
---

import { Tabs, Tab } from 'fumadocs-ui/components/tabs'
import { Callout } from 'fumadocs-ui/components/callout'

# Authentication

Commet SDK uses API key authentication with sandbox and production environments for safe testing and live billing.

## API Key Format

Commet API keys follow a predictable format for easy identification:

```
ck_xxx1234567890abcdef...  // Production API keys
```

<Callout type="warn">
**Security:** Never expose API keys in client-side code. Always use server-side routes or environment variables.
</Callout>

## Initialize Client

Configure your Commet client with your API key:

<Tabs items={['Basic Setup', 'With Options', 'Environment Variables']}>
<Tab value="Basic Setup">
```typescript
import { Commet } from 'commet'

const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!
})
```
</Tab>
<Tab value="With Options">
```typescript
import { Commet } from 'commet'

const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!,
  environment: 'sandbox',  // 'sandbox' (default) or 'production'
  debug: true,
  timeout: 30000,
  retries: 3
})
```
</Tab>
<Tab value="Environment Variables">
```bash title=".env.local"
COMMET_API_KEY=ck_xxx1234567890abcdef...
```

```typescript title="lib/commet.ts"
import { Commet } from 'commet'

export const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!
})
```
</Tab>
</Tabs>

## Environment Configuration

Choose between sandbox and production environments:

### Sandbox Environment (Default)

Safe environment for development and testing with real API calls to sandbox server:

```typescript
const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!,
  environment: 'sandbox' // Default - uses sandbox.commet.co
})

console.log(commet.getEnvironment()) // 'sandbox'
console.log(commet.isSandbox()) // true
```

### Production Environment

Live environment for real billing operations:

```typescript
const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!,
  environment: 'production' // Uses billing.commet.co
})

console.log(commet.getEnvironment()) // 'production'
console.log(commet.isProduction()) // true
```

## Configuration Options

Complete configuration reference:

```typescript
interface CommetConfig {
  apiKey: string                    // Required: Your API key
  environment?: 'sandbox' | 'production'  // Default: 'sandbox'
  debug?: boolean                   // Enable detailed logging
  timeout?: number                  // Request timeout (ms)
  retries?: number                  // Max retry attempts
}
```

## Debug Mode

Enable debug logging to see detailed request/response information:

```typescript
const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!,
  environment: 'sandbox',
  debug: true
})

// Console output:
// [Commet SDK] Initialized in sandbox mode
// API Key: ck_xxx12345...
// Base URL: https://sandbox.commet.co
```

## Validation

The SDK validates your configuration on initialization:

```typescript
// ❌ Missing API key
const commet = new Commet({})
// Error: Commet SDK: API key is required

// ❌ Invalid format
const commet = new Commet({
  apiKey: 'invalid-key'
})
// Error: Commet SDK: Invalid API key format. Expected format: ck_xxx...

// ✅ Valid configuration
const commet = new Commet({
  apiKey: 'ck_xxx1234567890abcdef'
})
```

## Best Practices

### Environment Separation

Use environment variables for different environments:

```typescript title="lib/commet.ts"
import { Commet } from 'commet'

export const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!,
  environment: process.env.NODE_ENV === 'production' ? 'production' : 'sandbox',
  debug: process.env.NODE_ENV !== 'production'
})
```

### Configuration Validation

Validate configuration at startup:

```typescript
if (!process.env.COMMET_API_KEY) {
  throw new Error('COMMET_API_KEY environment variable is required')
}

const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY
})
```

### Secure Storage

Never hardcode API keys:

```typescript
// ❌ Never do this
const commet = new Commet({
  apiKey: 'ck_xxx1234567890abcdef'
})

// ✅ Use environment variables
const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!
})
```

## Troubleshooting

### Check Environment Configuration

```typescript
const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!,
  debug: true
})

console.log('Environment:', commet.getEnvironment())
console.log('Is Sandbox:', commet.isSandbox())
console.log('Is Production:', commet.isProduction())
```

### Validate API Key Format

```typescript
const apiKey = process.env.COMMET_API_KEY
if (!apiKey?.startsWith('ck_')) {
  console.error('Invalid API key format')
}
```
