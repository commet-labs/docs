---
title: Dev Mode
description: Safe development with automatic event logging instead of API calls
---

import { Tabs, Tab } from 'fumadocs-ui/components/tabs'
import { Callout } from 'fumadocs-ui/components/callout'

# Dev Mode

Dev mode provides a safe development environment by logging events to the console instead of sending them to the server. Perfect for billing development without affecting production data.

<Callout type="info">
**Safe by Default:** The SDK automatically prevents development data from affecting production billing.
</Callout>

## Automatic Detection

The SDK automatically enables dev mode when it detects a development environment:

```typescript
import { Commet } from '@commet/sdk'

const commet = new Commet({
  apiKey: 'ck_xxx1234567890abcdef',
  // Dev mode auto-enabled when NODE_ENV=development
})

// In development
await commet.usage.events.create({
  eventType: 'api_call',
  customerId: 'cus_test_123'
})

// Console output:
// [Commet SDK] Dev mode
// Method: POST
// Endpoint: https://api.commet.co/api/usage/events
// Data: { eventType: 'api_call', customerId: 'cus_test_123' }
// Request logged, not sent to server
```

## Manual Control

Override automatic detection when needed:

<Tabs items={['Explicit Environment', 'Debug Logging', 'Environment Check']}>
<Tab value="Explicit Environment">
```typescript
const commet = new Commet({
  apiKey: 'ck_xxx1234567890abcdef',
  environment: 'development', // Force dev mode
})

// Always logs instead of sending, even in production environment
await commet.seats.add('cus_123', 'admin', 5)
```
</Tab>
<Tab value="Debug Logging">
```typescript
const commet = new Commet({
  apiKey: 'ck_xxx1234567890abcdef',
  debug: true, // Enable detailed logging
})

// Shows detailed request/response information
await commet.customers.create({
  legalName: 'Test Company'
})
```
</Tab>
<Tab value="Environment Check">
```typescript
const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!
})

console.log('Environment:', commet.getEnvironment())
console.log('Is Development:', commet.isDevelopment())
console.log('Is Production:', commet.isProduction())
```
</Tab>
</Tabs>

## Dev Mode Features

### Console Logging

All requests are logged with full details:

```typescript
await commet.usage.events.create({
  eventType: 'payment_processed',
  customerId: 'cus_test_123',
  properties: [
    { property: 'amount', value: '5000' },
    { property: 'currency', value: 'USD' }
  ]
})

// Console output:
// [Commet SDK] Dev mode
// Method: POST
// Endpoint: https://api.commet.co/api/usage/events
// Data: {
//   eventType: 'payment_processed',
//   customerId: 'cus_test_123',
//   properties: [
//     { property: 'amount', value: '5000' },
//     { property: 'currency', value: 'USD' }
//   ]
// }
// Request logged, not sent to server
```

### Mock Responses

Returns mock data for chaining:

```typescript
const result = await commet.customers.create({
  legalName: 'Test Company',
  currency: 'USD'
})

console.log(result)
// {
//   success: true,
//   devMode: true,
//   data: { id: 'dev_1642123456789' }
// }
```

## Environment Detection

### Detection Rules

Dev mode is enabled when:

**Node.js Environment:**
- `NODE_ENV === 'development'`
- `NODE_ENV === 'test'`

**Browser Environment:**
- `hostname === 'localhost'`
- `hostname === '127.0.0.1'`
- `hostname.startsWith('192.168.')`
- `hostname.startsWith('10.')`
- `hostname.endsWith('.local')`

### Check Environment

Verify environment detection:

```typescript
const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!,
  debug: true
})

console.log('Environment:', commet.getEnvironment())
console.log('Is Development:', commet.isDevelopment())
console.log('Is Production:', commet.isProduction())

// With debug enabled:
// [Commet SDK] Initialized in development mode
// Dev mode: Events will be logged to console, not sent to server
```

## Development Workflow

### Testing Billing Logic

Test your billing integration safely:

```typescript
// Development - logs only
const processPayment = async (customerId: string, amount: number) => {
  // Your payment logic here...
  
  // Track usage - safe in development
  await commet.usage.events.create({
    eventType: 'payment_processed',
    customerId,
    properties: [
      { property: 'amount', value: amount.toString() }
    ]
  })
  
  // Add seats based on plan
  await commet.seats.add(customerId, 'user', 10)
}

await processPayment('cus_test_123', 5000)
// All logged to console, no real charges
```

### Batch Testing

Test bulk operations safely:

```typescript
const events = Array.from({ length: 100 }, (_, i) => ({
  eventType: 'api_call',
  customerId: `cus_test_${i}`,
  properties: [
    { property: 'endpoint', value: '/api/test' }
  ]
}))

await commet.usage.events.createBatch({ events })

// Console output:
// [Commet SDK] Dev mode
// Method: POST
// Endpoint: https://api.commet.co/api/usage/events/batch
// Data: { events: [100 events...] }
// Request logged, not sent to server
```

## Production Deployment

### Environment Configuration

Configure for production deployment:

```typescript title="lib/commet.ts"
const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!,
  // Automatically uses production when NODE_ENV=production
  debug: process.env.NODE_ENV === 'development'
})
```

### Deployment Checklist

Before deploying to production:

- [ ] Verify `NODE_ENV=production` is set
- [ ] Use production API key
- [ ] Disable debug logging
- [ ] Test environment detection

## Best Practices

### Environment Variables

Use environment-specific configuration:

```bash title=".env.local"
# Development (uses dev mode automatically)
NODE_ENV=development
COMMET_API_KEY=ck_xxx1234567890abcdef

# Production
NODE_ENV=production
COMMET_API_KEY=ck_xxx1234567890abcdef
```

### Development Debugging

Use debug mode for troubleshooting:

```typescript
const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!,
  debug: true
})

// Shows full request/response details
await commet.customers.list({ limit: 5 })
```

### Testing Real API

Test with real API in controlled way:

```typescript
const commet = new Commet({
  apiKey: process.env.COMMET_API_KEY!,
  environment: process.env.TEST_REAL_API === 'true' ? 'production' : 'auto'
})

// Only sends real requests when explicitly enabled
await commet.usage.events.create({
  eventType: 'test_event',
  customerId: 'cus_test_safe'
})
```

## What's next?

<div className="grid grid-cols-1 md:grid-cols-2 gap-4">
  <div className="border rounded-lg p-4">
    <h3 className="font-semibold mt-0">Error Handling</h3>
    <p className="text-sm text-muted-foreground">Robust error handling patterns</p>
    <p className="text-sm">[Handle errors →](/library/core/error-handling)</p>
  </div>
  
  <div className="border rounded-lg p-4">
    <h3 className="font-semibold mt-0">Environments</h3>
    <p className="text-sm text-muted-foreground">Manage different environments</p>
    <p className="text-sm">[Environment setup →](/library/core/environments)</p>
  </div>
</div>
