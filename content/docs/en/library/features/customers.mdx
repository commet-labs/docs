---
title: Customer Management
description: Complete customer lifecycle management with addresses and taxation
---

import { Tabs, Tab } from 'fumadocs-ui/components/tabs'
import { Callout } from 'fumadocs-ui/components/callout'

# Customer Management

Manage the complete customer lifecycle with automatic address-based tax calculations and multi-currency support.

<Callout type="info">
**Prerequisites:** Initialize your Commet client with a valid API key.
</Callout>

## Basic Operations

### Create Customer

Create a new customer with required billing information:

```typescript
const customer = await commet.customers.create({
  legalName: 'Acme Corporation',
  displayName: 'Acme Corp',
  currency: 'USD',
  address: {
    line1: '123 Business St',
    line2: 'Suite 100',
    city: 'San Francisco',
    state: 'CA',
    postalCode: '94105',
    country: 'US'
  },
  billingEmail: 'billing@acme.com'
})

console.log('Customer created:', customer.data.id)
```

### Retrieve Customer

Get customer details by ID:

```typescript
const customer = await commet.customers.retrieve('cus_A1b2C3d4E5f6G7h8I9j0K1l2')

console.log('Customer:', customer.data.legalName)
```

### Update Customer

Modify customer information:

```typescript
const updated = await commet.customers.update('cus_A1b2C3d4E5f6G7h8I9j0K1l2', {
  displayName: 'Acme Corporation Ltd',
  billingEmail: 'accounts@acme.com'
})
```

### List Customers

Retrieve customers with filtering and pagination:

```typescript
const customers = await commet.customers.list({
  currency: 'USD',
  isActive: true,
  limit: 50
})

console.log(`Found ${customers.data.length} customers`)
```

## Tax Configuration

Configure tax handling based on customer location:

<Tabs items={['Taxed', 'Tax Exempt', 'Reverse Charge', 'Not Applicable']}>
<Tab value="Taxed">
```typescript
await commet.customers.create({
  legalName: 'Standard Corp',
  taxStatus: 'TAXED',
  currency: 'USD',
  address: {
    line1: '456 Commerce Ave',
    city: 'New York',
    state: 'NY',
    postalCode: '10001',
    country: 'US'
  }
})
```
</Tab>
<Tab value="Tax Exempt">
```typescript
await commet.customers.create({
  legalName: 'Non-Profit Organization',
  taxStatus: 'TAX_EXEMPT',
  currency: 'USD',
  metadata: {
    tax_exempt_id: '501c3-12345'
  }
})
```
</Tab>
<Tab value="Reverse Charge">
```typescript
await commet.customers.create({
  legalName: 'European Business Ltd',
  taxStatus: 'REVERSE_CHARGE',
  currency: 'EUR',
  address: {
    line1: 'Business Park 1',
    city: 'Amsterdam',
    postalCode: '1000 AA',
    country: 'NL'
  }
})
```
</Tab>
<Tab value="Not Applicable">
```typescript
await commet.customers.create({
  legalName: 'International Org',
  taxStatus: 'NOT_APPLICABLE',
  currency: 'USD'
})
```
</Tab>
</Tabs>

## Multi-Currency Support

Create customers in different currencies:

```typescript
// USD Customer
const usdCustomer = await commet.customers.create({
  legalName: 'US Company',
  currency: 'USD',
  address: { 
    line1: '123 Main St',
    city: 'New York',
    state: 'NY',
    postalCode: '10001',
    country: 'US'
  }
})

// EUR Customer  
const eurCustomer = await commet.customers.create({
  legalName: 'German GmbH',
  currency: 'EUR',
  address: {
    line1: 'Hauptstraße 1',
    city: 'Berlin',
    postalCode: '10115',
    country: 'DE'
  }
})

// LATAM Customer
const brlCustomer = await commet.customers.create({
  legalName: 'Empresa Brasil Ltda',
  currency: 'BRL',
  language: 'pt',
  address: {
    line1: 'Rua Principal 123',
    city: 'São Paulo',
    state: 'SP',
    postalCode: '01000-000',
    country: 'BR'
  }
})
```

## Customer Properties

### Required Fields

```typescript
await commet.customers.create({
  legalName: 'Required Company Name',  // Required
  currency: 'USD',                     // Optional, defaults based on address
  address: {                           // Required
    line1: '123 Required St',          // Required
    city: 'Required City',             // Required
    postalCode: '12345',               // Required
    country: 'US'                      // Required (ISO-2 format)
  }
})
```

### Optional Fields

```typescript
await commet.customers.create({
  legalName: 'Full Example Corp',
  displayName: 'Full Example',         // Optional display name
  domain: 'example.com',               // Optional company domain
  website: 'https://example.com',      // Optional website
  taxStatus: 'TAXED',                  // Optional, defaults to TAXED
  currency: 'USD',
  address: {
    line1: '123 Business St',
    line2: 'Suite 100',                // Optional
    city: 'San Francisco',
    state: 'CA',                       // Required for US/CA
    postalCode: '94105',
    country: 'US',
    region: 'North America'            // Optional
  },
  billingEmail: 'billing@example.com', // Optional
  paymentTerms: 'net_30',              // Optional
  timezone: 'America/Los_Angeles',     // Optional
  language: 'en',                      // Optional
  industry: 'software',                // Optional
  employeeCount: '11-50',              // Optional
  metadata: {                          // Optional custom data
    salesforce_id: 'sf_123',
    customer_tier: 'enterprise'
  }
})
```

## Advanced Features

### Search Customers

Search customers by name or other criteria:

```typescript
const results = await commet.customers.list({
  search: 'acme',
  currency: 'USD',
  taxStatus: 'TAXED',
  isActive: true
})
```

### Custom Metadata

Store additional data with customers:

```typescript
await commet.customers.update('cus_A1b2C3d4E5f6G7h8I9j0K1l2', {
  metadata: {
    crm_id: 'sf_123456',
    tier: 'enterprise',
    onboarding_date: '2024-01-15',
    account_manager: 'john.doe@company.com'
  }
})
```

### Deactivate Customer

Soft delete customers when needed:

```typescript
// Deactivate customer
await commet.customers.deactivate('cus_A1b2C3d4E5f6G7h8I9j0K1l2')

// Reactivate customer  
await commet.customers.update('cus_A1b2C3d4E5f6G7h8I9j0K1l2', {
  isActive: true
})
```

## Error Handling

Handle common customer management scenarios:

```typescript
try {
  const customer = await commet.customers.create({
    legalName: 'New Customer',
    currency: 'USD',
    address: {
      line1: '123 Main St',
      city: 'Anytown',
      postalCode: '12345',
      country: 'US'
    }
  })
} catch (error) {
  if (error instanceof CommetValidationError) {
    console.log('Validation errors:', error.validationErrors)
  } else if (error instanceof CommetAPIError) {
    console.log('API error:', error.statusCode, error.message)
  }
}
```

## Best Practices

### Complete Addresses

Always include complete addresses for accurate tax calculation:

```typescript
// ✅ Complete address
address: {
  line1: '123 Business St',
  line2: 'Suite 100',    // Optional but helpful
  city: 'San Francisco',
  state: 'CA',           // Required for US/CA
  postalCode: '94105',
  country: 'US'          // ISO-2 format
}

// ❌ Incomplete address
address: {
  line1: '123 Business St',
  country: 'US' // Missing required city and postalCode
}
```

### Currency Consistency

Match customer currency with their billing region:

```typescript
// ✅ Consistent
{ currency: 'EUR', address: { country: 'DE' }}
{ currency: 'BRL', address: { country: 'BR' }}
{ currency: 'USD', address: { country: 'US' }}

// ⚠️ May need review
{ currency: 'USD', address: { country: 'DE' }}
```

### Structured Metadata

Keep metadata flat and searchable:

```typescript
// ✅ Good structure
metadata: {
  crm_id: 'sf_12345',
  tier: 'enterprise',
  industry: 'fintech'
}

// ❌ Avoid nested objects
metadata: {
  crm: {
    salesforce: { id: 'sf_12345' }
  }
}
```

## What's next?

<div className="grid grid-cols-1 md:grid-cols-2 gap-4">
  <div className="border rounded-lg p-4">
    <h3 className="font-semibold mt-0">Usage Events</h3>
    <p className="text-sm text-muted-foreground">Track customer usage for billing</p>
    <p className="text-sm">[Track usage →](/library/features/usage-events)</p>
  </div>
  
  <div className="border rounded-lg p-4">
    <h3 className="font-semibold mt-0">Seat Management</h3>
    <p className="text-sm text-muted-foreground">Manage subscription seats</p>
    <p className="text-sm">[Manage seats →](/library/features/seat-management)</p>
  </div>
</div>
